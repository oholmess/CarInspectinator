# Test Reports

This directory contains automated test reports generated by the CI/CD pipeline.

## Contents

- `coverage.txt` - Human-readable code coverage report
- `coverage.json` - Machine-readable coverage data
- Test results from GitHub Actions runs

## Latest Test Run

ðŸ“Š **Code Coverage**: Will be updated automatically by CI
ðŸ§ª **Total Tests**: Will be updated automatically by CI
âœ… **Passing**: Will be updated automatically by CI
âŒ **Failing**: Will be updated automatically by CI

## How It Works

1. **Automated Generation**: Reports are generated automatically on every push to `main` branch
2. **CI Integration**: GitHub Actions runs tests and generates coverage data
3. **Auto-Commit**: Coverage reports are committed back to this directory
4. **PR Comments**: Coverage summaries are posted as comments on pull requests

## Viewing Reports

### Latest Coverage
The most recent coverage report is always available at:
- `coverage.txt` - Text format
- `coverage.json` - JSON format

### Historical Data
Check the git history of this directory to see coverage trends over time:

```bash
git log --oneline -- test-reports/
```

## CI Badge

Add this to your README to show current coverage:

```markdown
![Coverage](https://img.shields.io/badge/coverage-XX%25-brightgreen)
```

## Coverage Threshold

- **Minimum**: 70%
- **Target**: 80%+
- **Excellent**: 90%+

## Test Categories

### Unit Tests
- Services: `CarService`, `ModelDownloader`
- Utilities: `MeasurementCodec`, `ErrorHandler`
- Network: `NetworkHandler`
- View Models: `HomePageViewModel`

### Integration Tests
- Full stack testing
- Dependency injection validation
- End-to-end flows

## Updating Reports Locally

To generate reports locally:

```bash
cd vision-pro

# Run tests with coverage
xcodebuild test \
  -project CarInspectinator.xcodeproj \
  -scheme CarInspectinator \
  -destination 'platform=visionOS Simulator,name=Apple Vision Pro' \
  -enableCodeCoverage YES \
  -derivedDataPath DerivedData

# Generate reports
xcrun xccov view --report DerivedData/Logs/Test/*.xcresult > ../test-reports/coverage.txt
xcrun xccov view --report --json DerivedData/Logs/Test/*.xcresult > ../test-reports/coverage.json
```

## Report Format

### Coverage Report Structure

```
CarInspectinator.app
â”œâ”€â”€ Services/
â”‚   â”œâ”€â”€ CarService.swift: XX.X%
â”‚   â”œâ”€â”€ ModelDownloader.swift: XX.X%
â”‚   â””â”€â”€ ConfigurationService.swift: XX.X%
â”œâ”€â”€ Utilities/
â”‚   â”œâ”€â”€ MeasurementCodec.swift: XX.X%
â”‚   â””â”€â”€ ErrorHandler.swift: XX.X%
â”œâ”€â”€ Network/
â”‚   â”œâ”€â”€ NetworkHandler.swift: XX.X%
â”‚   â””â”€â”€ NetworkRoutes.swift: XX.X%
â”œâ”€â”€ View Models/
â”‚   â””â”€â”€ HomePageViewModel.swift: XX.X%
â””â”€â”€ Models/
    â””â”€â”€ Car.swift: XX.X%

Total Coverage: XX.X%
```

## Troubleshooting

### Reports Not Updating

1. Check GitHub Actions workflow status
2. Verify push permissions for the bot
3. Check for workflow file syntax errors
4. Review Action logs for errors

### Coverage Seems Wrong

1. Ensure tests are actually running
2. Verify `-enableCodeCoverage YES` flag is set
3. Check that all test targets are included
4. Review which files are excluded from coverage

## Links

- [Testing Guide](../TESTING_GUIDE.md)
- [CI Workflow](../.github/workflows/ci.yml)
- [Coverage Workflow](../.github/workflows/coverage-report.yml)

